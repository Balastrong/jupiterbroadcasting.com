{{ define "main" }}
{{ $lastUrlElement := (delimit (split .Permalink "/" | last 2 | first 1 ) "") }}
{{ if eq $lastUrlElement "hosts" }}
  <section class="host-list">
    <div class="container">
       <div class="columns is-multiline">
        {{ range $index, $hostname := .Params.hosts }}
          {{ $host := index $.Site.Data.people $hostname }}
          <div class="column is-6 is-4-fullhd is-4-desktop is-12-mobile"  style="display: flex;">
            {{ partial "people/small.html" (dict "context" . "host" $host) }}
          </div>
        {{ end }}
      </div>
    </div>
  </section>
{{ else }}
<div class="container">
  <h1 class="title">{{.Title}}</h1>
</div>
<div class="container">
  <div class="columns">
    {{ if isset .Params "hosts" }}
      <div class="column is-half">
        {{.Content}}
        {{with .Params.links}}
            {{ partial "show/links.html" . }}
        {{end}}
      </div>
      <div class="column is-half">
        <h2 class="subtitle has-text-centered-mobile">Your Hosts</h2>
        <div class="columns is-multiline">
        {{ range .Params.hosts }}
          {{ $host := index (where (where site.RegularPages "Section" "people") "Params.username" .) 0 }}
            <div class="column is-narrow">
              {{ partial "people/smallest.html" $host }}
            </div>
        {{ end }}
        </div>
      </div>
    {{else}}
        <div class="column is-full">
          {{.Content}}
        </div>
    {{end}}
  </div>
</div>

<section class="section episode-list">
  <div class="container">
     <div class="columns is-multiline">

        {{ $episode_paginator := .Paginate (where .Pages "Type" "episode") }}
        {{ range $episode_paginator.Pages }}
        <div class="column is-6 is-4-fullhd is-4-desktop is-12-mobile"  style="display: flex;">
          {{ partial "episode/preview.html" . }}
        </div>
        {{ end }}
      </div>
    </div>
    <div class="container">
          {{ partial "helper/pagination.html" . }}
    </div>
</section>

{{ end }}
{{ end }}
